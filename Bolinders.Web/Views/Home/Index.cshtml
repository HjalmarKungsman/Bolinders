@{
    ViewData["Title"] = "Bolinders Bil AB";
}

<style>
    h1, h2, h3, h4 {
        text-align: center;
        font-family: 'Russo One', sans-serif;
    }
</style>
<link href="~/css/imageCarousel.css" rel="stylesheet" />

<div class="row">
    <div class="col-lg-12" style="margin-bottom: 10%;">

        <div class="col-md-6 col-md-offset-3" style="margin-top:20%">
            <form method="post" asp-action="list" asp-controller="vehicles">
                <div class="form-group">
                    <input type="hidden" id="page" name="page" value="1" />
                    <h2>Vad för bil söker du?</h2>
                    <div class="input-group" style="display: inline-flex">
                        <input type="text" class="form-control input-lg" id="searchText" name="searchText" placeholder="Söktext" value="@ViewBag.SearchText" />
                        <select class="form-control selectpicker input-lg" style="max-width:190px" id="used" name="used">
                            <option value="null" title="Alla bilar">Alla bilar</option>
                            <option value="false" title="Nya">Nya bilar</option>
                            <option value="true" title="Begagnade">Begagnade bilar</option>
                        </select>
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-default input-lg">Sök</button>
                        </span>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="row" style="margin-top:30%;">
    <div class="col-md-4">
        <h2>Nya bilar</h2>
        <hr />
        <a href="/bilar/nya"><img class="img-responsive" src="~/images/newcar.jpg" alt="Nya bilar" /></a>
    </div>
    <div class="col-md-4">
        <h2>Begagnade bilar</h2>
        <hr />
        <a href="/bilar/begagnade/"><img class="img-responsive" src="~/images/usedcar.jpg" alt="Begagnade bilar" /></a>
    </div>
    <div class="col-md-4">
        <h2>Kontakta Oss</h2>
        <hr />
        <a href="/kontakt/"><img class="img-responsive" src="~/images/contact.jpg" alt="Begagnade bilar" /></a>
    </div>

</div>
<div class="row" style="margin-top:0%; margin-bottom:5%;">
    <div class="col-md-12">
        <h2>Bilmärken i lager</h2>
        <hr />
        <div class="carousel slide multi-item-carousel" id="theCarousel">
            <div class="carousel-inner">
                @for (int i = 0; i < ViewBag.Makes.Count; i++)
                {
                    if (i == 0)
                    {
                        <div class="item active">
                            <div class="col-xs-4">
                                <a href="bilar/sida/1?make=@ViewBag.Makes[i].Id"><img src="~/images/vehiclelogotypes/@ViewBag.Makes[i].LogotypeFileName" style="margin: 0 auto" alt="@ViewBag.Makes[i].Name" class="img-responsive" /></a>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="item">
                            <div class="col-xs-4">
                                <a href="bilar/sida/1?make=@ViewBag.Makes[i].Id"><img src="~/images/vehiclelogotypes/@ViewBag.Makes[i].LogotypeFileName" style="margin: 0 auto" alt="@ViewBag.Makes[i].Name" class="img-responsive" /></a>
                            </div>
                        </div>
                    }
                }
            </div>
            <a class="left carousel-control" href="#theCarousel" data-slide="prev"><i class="glyphicon glyphicon-chevron-left"></i></a>
            <a class="right carousel-control" href="#theCarousel" data-slide="next"><i class="glyphicon glyphicon-chevron-right"></i></a>
        </div>

    </div>
    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.10/handlebars.js"></script>
    <script>
        $("body").addClass("main-front");
    </script>
</div>
<div id="nyheter">

</div>

<script id="template" type="text/x-handlebars-template">
    <div>
        {{#each this}}
        <div class="row">
            <div class="col-md-12">
                <h2>{{title}}</h2> <br />
                <strong>Datum: </strong>{{publishedAt}} <br />
                <strong>Ingress: </strong>{{description}} <a target="_blank" href="{{url}}">Läs mer!</a> <br />

            </div>
        </div>
        {{/each}}
    </div>
</script>

<script>
    var result = [];
    var articles = [];

    $.getJSON("https://newsapi.org/v1/articles?source=the-new-york-times&sortBy=top&apiKey=c28affb30c8842d78eedfd209f451423", function (data) {
        result = data;

        $.each(result.articles, function (i, ob) {

                var shortText = jQuery.trim(ob.description).substring(0, 50)
                .split(" ").slice(0, -1).join(" ") + "...";

                ob.description = shortText;

                articles.push(ob)      
        });

        articles.sort(function (a, b) {
            var c = new Date(a.publishedAt);
            var d = new Date(b.publishedAt);
            return d - c;

        });

        if (articles.length > 3) {
            articles.length = 3;
        }
  
        var source = $("#template").html();
        var template = Handlebars.compile(source);
        var html = template(articles);
        $('#nyheter').html(html);

        console.log(articles)
    });

</script>
